From dc2179c05be234c071722f74c66ccdc160200c87 Mon Sep 17 00:00:00 2001
From: Florian Maerkl <info@florianmaerkl.de>
Date: Fri, 12 Jun 2020 11:01:19 +0200
Subject: [PATCH 15/23] Support ARM+AArch64 in Decompiler

---
 Ghidra/Features/Decompiler/src/decompile/cpp/types.h | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

diff --git a/Ghidra/Features/Decompiler/src/decompile/cpp/types.h b/Ghidra/Features/Decompiler/src/decompile/cpp/types.h
index d10906637..ff6f423ab 100644
--- a/Ghidra/Features/Decompiler/src/decompile/cpp/types.h
+++ b/Ghidra/Features/Decompiler/src/decompile/cpp/types.h
@@ -71,8 +71,12 @@ typedef char int1;
 typedef uint8 uintp;
 #endif
 
-#if defined (__linux__) && defined (__i386__)
+#if defined (__linux__) && (defined (__i386__) || defined (__arm__))
+#if defined(__BYTE_ORDER__) && __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+#define HOST_ENDIAN 1
+#else
 #define HOST_ENDIAN 0
+#endif
 typedef unsigned long uintm;
 typedef long intm;
 typedef unsigned long long uint8;
@@ -86,8 +90,12 @@ typedef char int1;
 typedef uint4 uintp;
 #endif
 
-#if defined (__linux__) && defined (__x86_64__)
+#if defined (__linux__) && (defined (__x86_64__) || defined (__aarch64__))
+#if defined(__BYTE_ORDER__) && __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+#define HOST_ENDIAN 1
+#else
 #define HOST_ENDIAN 0
+#endif
 typedef unsigned int uintm;
 typedef int intm;
 typedef unsigned long uint8;
-- 
2.24.3 (Apple Git-128)

